<!doctype html>
<html lang="en-CA">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Feeling Lucky? Take Today’s Luck Test</title>
  <meta name="description" content="Pick one symbol. One click per day. Your luck, measured lightly." />
  <style>
    :root {
      --bg: #ffffff;
      --fg: #111111;
      --muted: #666666;
      --card: #f6f6f6;
      --border: #e6e6e6;
      --good: #0a7a2f;
      --bad: #b00020;
    }
    html, body {
      margin: 0;
      padding: 0;
      background: var(--bg);
      color: var(--fg);
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
    }
    .wrap {
      max-width: 980px;
      margin: 0 auto;
      padding: 18px 14px 40px;
    }
    header {
      display: flex;
      flex-direction: column;
      gap: 8px;
      margin-bottom: 14px;
    }
    h1 {
      font-size: clamp(22px, 2.6vw, 34px);
      line-height: 1.1;
      margin: 0;
      letter-spacing: -0.02em;
    }
    .sub {
      font-size: 14px;
      color: var(--muted);
      line-height: 1.4;
    }
    .row {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      align-items: center;
    }
    a {
      color: var(--fg);
      text-decoration: underline;
      text-underline-offset: 2px;
    }
    .pill {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 8px 10px;
      border: 1px solid var(--border);
      border-radius: 999px;
      font-size: 13px;
      color: var(--muted);
      background: #fff;
    }
    .grid {
      display: grid;
      grid-template-columns: repeat(5, minmax(0, 1fr));
      gap: 10px;
      margin-top: 12px;
    }
    @media (max-width: 520px) {
      .grid { gap: 8px; }
    }
    .tile {
      border: 1px solid var(--border);
      background: #fff;
      border-radius: 14px;
      aspect-ratio: 1 / 1;
      display: grid;
      place-items: center;
      cursor: pointer;
      user-select: none;
      transition: transform 120ms ease, box-shadow 120ms ease, border-color 120ms ease;
      position: relative;
      overflow: hidden;
    }
    .tile:hover {
      transform: translateY(-1px);
      box-shadow: 0 6px 18px rgba(0,0,0,0.06);
      border-color: #d8d8d8;
    }
    .tile:active {
      transform: translateY(0px) scale(0.99);
      box-shadow: 0 4px 12px rgba(0,0,0,0.06);
    }
    .tile[disabled] {
      cursor: not-allowed;
      opacity: 0.65;
      transform: none;
      box-shadow: none;
    }
    .icon {
      width: min(46px, 9vw);
      height: min(46px, 9vw);
      max-width: 54px;
      max-height: 54px;
      color: var(--fg);
    }
    .label {
      position: absolute;
      bottom: 8px;
      left: 8px;
      right: 8px;
      font-size: 11px;
      color: transparent;
      text-align: center;
      pointer-events: none;
    }

    .panel {
      margin-top: 14px;
      border: 1px solid var(--border);
      background: var(--card);
      border-radius: 16px;
      padding: 12px;
      display: grid;
      gap: 10px;
    }
    .result {
      background: #fff;
      border: 1px solid var(--border);
      border-radius: 14px;
      padding: 12px;
      display: grid;
      gap: 6px;
    }
    .result h2 {
      margin: 0;
      font-size: 16px;
    }
    .result p {
      margin: 0;
      color: var(--muted);
      line-height: 1.45;
      font-size: 14px;
    }
    .tagline {
      font-size: 13px;
      color: var(--muted);
    }
    .scoreline {
      display: flex;
      gap: 8px;
      flex-wrap: wrap;
      align-items: center;
      margin-top: 4px;
    }
    .badge {
      padding: 6px 10px;
      border-radius: 999px;
      border: 1px solid var(--border);
      background: #fff;
      font-size: 13px;
      color: var(--fg);
      display: inline-flex;
      gap: 8px;
      align-items: center;
    }
    .badge.good { border-color: rgba(10,122,47,0.25); }
    .badge.bad { border-color: rgba(176,0,32,0.25); }
    .badge.good strong { color: var(--good); }
    .badge.bad strong { color: var(--bad); }

    .stats {
      display: grid;
      gap: 8px;
      grid-template-columns: repeat(4, minmax(0, 1fr));
    }
    @media (max-width: 760px) {
      .stats { grid-template-columns: repeat(2, minmax(0, 1fr)); }
    }
    .stat {
      background: #fff;
      border: 1px solid var(--border);
      border-radius: 14px;
      padding: 10px;
    }
    .stat .k {
      font-size: 12px;
      color: var(--muted);
      margin-bottom: 4px;
    }
    .stat .v {
      font-size: 18px;
      font-weight: 650;
      letter-spacing: -0.01em;
    }

    .btnrow {
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
      align-items: center;
      justify-content: space-between;
    }
    button {
      appearance: none;
      border: 1px solid var(--border);
      background: #fff;
      color: var(--fg);
      border-radius: 999px;
      padding: 10px 12px;
      font-size: 13px;
      cursor: pointer;
    }
    button:hover { border-color: #d8d8d8; }
    .tiny {
      font-size: 12px;
      color: var(--muted);
    }
  </style>
</head>
<body>
  <div class="wrap">
    <header>
      <h1>Feeling lucky? Take today’s Luck Test.</h1>
      <div class="sub">
        One click per day. Pick a symbol. Get a reading.
        From the author of <em>Getting Lucky</em>.
        <span id="buyWrap" style="display:none;"> <a id="buyLink" href="#" rel="noopener">Buy the book</a></span>
      </div>
      <div class="row">
        <div class="pill" id="todayPill">Today: </div>
        <div class="pill" id="rulePill">Rule: one pick per day</div>
      </div>
    </header>

    <div class="grid" id="grid" aria-label="Luck symbol grid"></div>

    <div class="panel" id="panel">
      <div class="result" id="resultBox">
        <h2 id="resultTitle">Pick your lucky symbol for today.</h2>
        <p id="resultText">No hints. No do-overs. We are not calling this science.</p>
        <div class="scoreline" id="scoreLine" style="display:none;"></div>
      </div>

      <div class="btnrow">
        <div class="tiny" id="lockNote"></div>
        <button id="resetBtn" type="button" title="Clears your local stats and lets you test again today (for development only).">Dev: reset local data</button>
      </div>

      <div class="stats" id="statsBox" style="display:none;"></div>
    </div>
  </div>

<script>
  // ---------------------------
  // Utilities: date + seeded RNG
  // ---------------------------
  function formatDateLocal(d) {
    // Uses user's local time. Easy and expected.
    const yyyy = d.getFullYear();
    const mm = String(d.getMonth() + 1).padStart(2, "0");
    const dd = String(d.getDate()).padStart(2, "0");
    return `${yyyy}-${mm}-${dd}`;
  }

  function hashString(str) {
    // Simple 32-bit hash
    let h = 2166136261 >>> 0;
    for (let i = 0; i < str.length; i++) {
      h ^= str.charCodeAt(i);
      h = Math.imul(h, 16777619);
    }
    return h >>> 0;
  }

  function mulberry32(seed) {
    return function() {
      let t = seed += 0x6D2B79F5;
      t = Math.imul(t ^ (t >>> 15), t | 1);
      t ^= t + Math.imul(t ^ (t >>> 7), t | 61);
      return ((t ^ (t >>> 14)) >>> 0) / 4294967296;
    }
  }

  function pickUniqueIndices(rng, n, count) {
    const pool = Array.from({ length: n }, (_, i) => i);
    // Fisher-Yates partial shuffle
    for (let i = n - 1; i > 0; i--) {
      const j = Math.floor(rng() * (i + 1));
      [pool[i], pool[j]] = [pool[j], pool[i]];
    }
    return pool.slice(0, count);
  }

  // ---------------------------
  // Identity (per device)
  // ---------------------------
  const LS = {
    uid: "lucktest_uid_v1",
    last: "lucktest_last_v1",
    stats: "lucktest_stats_v1",
  };

  function getOrCreateUID() {
    let uid = localStorage.getItem(LS.uid);
    if (!uid) {
      uid = (crypto && crypto.randomUUID) ? crypto.randomUUID() : String(Date.now()) + "_" + Math.random().toString(16).slice(2);
      localStorage.setItem(LS.uid, uid);
    }
    return uid;
  }

  // ---------------------------
  // SVG Icon Set (25 unique)
  // Minimal, consistent stroke style
  // ---------------------------
  const ICONS = [
    { name: "Clover", svg: `<svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.7" stroke-linecap="round" stroke-linejoin="round"><path d="M12 14c-1.2 2.5-3.7 4-6 4 0-2.7 1.8-5 4.2-5.6"/><path d="M12 14c1.2 2.5 3.7 4 6 4 0-2.7-1.8-5-4.2-5.6"/><path d="M12 14c-2.4 0-4.5-1.6-4.5-4 0-1.7 1.3-3 3-3 1.2 0 2.2.7 2.6 1.7.4-1 1.4-1.7 2.6-1.7 1.7 0 3 1.3 3 3 0 2.4-2.1 4-4.7 4"/><path d="M12 14v7"/></svg>` },
    { name: "Horseshoe", svg: `<svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.7" stroke-linecap="round" stroke-linejoin="round"><path d="M7 3c-2.2 0-4 1.8-4 4v6c0 5 4 8 9 8s9-3 9-8V7c0-2.2-1.8-4-4-4"/><path d="M7 7h.01M7 11h.01M7 15h.01M17 7h.01M17 11h.01M17 15h.01"/></svg>` },
    { name: "Star", svg: `<svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.7" stroke-linecap="round" stroke-linejoin="round"><path d="M12 2l2.8 6 6.5.6-4.9 4.2 1.5 6.3L12 16.9 6.1 19.1l1.5-6.3L2.7 8.6l6.5-.6L12 2z"/></svg>` },
    { name: "Coin", svg: `<svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.7" stroke-linecap="round" stroke-linejoin="round"><ellipse cx="12" cy="8" rx="7" ry="3"/><path d="M5 8v8c0 1.7 3.1 3 7 3s7-1.3 7-3V8"/><path d="M5 12c0 1.7 3.1 3 7 3s7-1.3 7-3"/></svg>` },
    { name: "Key", svg: `<svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.7" stroke-linecap="round" stroke-linejoin="round"><circle cx="7.5" cy="14.5" r="3.5"/><path d="M11 14.5h10l-2 2 2 2-2 2"/></svg>` },
    { name: "Dice", svg: `<svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.7" stroke-linecap="round" stroke-linejoin="round"><rect x="4" y="4" width="16" height="16" rx="3"/><path d="M8 8h.01M12 12h.01M16 16h.01"/></svg>` },
    { name: "Rabbit", svg: `<svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.7" stroke-linecap="round" stroke-linejoin="round"><path d="M8 7c-1.3-2.6-.6-4.5.6-5.5M12 7c.3-3.1 2-5 4-5.8"/><path d="M6.5 14.5c0-3.3 2.6-6 5.5-6s5.5 2.7 5.5 6-2.6 6-5.5 6-5.5-2.7-5.5-6z"/><path d="M10 14h.01M14 14h.01"/><path d="M11 17c.6.4 1.4.4 2 0"/></svg>` },
    { name: "Elephant", svg: `<svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.7" stroke-linecap="round" stroke-linejoin="round"><path d="M7 15c0-4.4 3.1-8 7-8 4 0 7 2.7 7 7v4h-4v-2H9v2H5v-3"/><path d="M14 7c-1.2 1.5-2 3.5-2 5.5 0 2.2.7 4.1 2 5.5"/><path d="M18 14c0 2-1.2 3.5-3 3.5"/></svg>` },
    { name: "Ladybug", svg: `<svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.7" stroke-linecap="round" stroke-linejoin="round"><path d="M12 20c4 0 7-3.6 7-8s-3-8-7-8-7 3.6-7 8 3 8 7 8z"/><path d="M12 4v16"/><path d="M9 7h.01M15 7h.01M8 10h.01M16 10h.01"/></svg>` },
    { name: "Lantern", svg: `<svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.7" stroke-linecap="round" stroke-linejoin="round"><path d="M8 4h8"/><path d="M9 4c0 3-2 4-2 7s2 4 5 4 5-1 5-4-2-4-2-7"/><path d="M7 11h10"/><path d="M10 15v5h4v-5"/></svg>` },
    { name: "Crown", svg: `<svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.7" stroke-linecap="round" stroke-linejoin="round"><path d="M4 8l4 4 4-6 4 6 4-4v10H4V8z"/><path d="M4 18h16"/></svg>` },
    { name: "Feather", svg: `<svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.7" stroke-linecap="round" stroke-linejoin="round"><path d="M20 7c-4 0-8 4-10 6-2.5 2.5-3 6-3 8 2 0 5.5-.5 8-3 2-2 6-6 6-11z"/><path d="M9 13l6 6"/><path d="M11 11l4 4"/></svg>` },
    { name: "Heart", svg: `<svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.7" stroke-linecap="round" stroke-linejoin="round"><path d="M12 21s-7-4.4-9.5-9C.5 8 3 5.5 6 6c1.6.3 2.7 1.5 3 2 0 0 1.4-2.7 4-2.7 2.7 0 4.7 2.3 4.5 5.2C17.2 15.8 12 21 12 21z"/></svg>` },
    { name: "Moon", svg: `<svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.7" stroke-linecap="round" stroke-linejoin="round"><path d="M21 14.5A8.5 8.5 0 1 1 9.5 3.2 7 7 0 0 0 21 14.5z"/></svg>` },
    { name: "Sun", svg: `<svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.7" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="4"/><path d="M12 2v3M12 19v3M2 12h3M19 12h3M4.2 4.2l2.1 2.1M17.7 17.7l2.1 2.1M19.8 4.2l-2.1 2.1M6.3 17.7l-2.1 2.1"/></svg>` },
    { name: "Anchor", svg: `<svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.7" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="5" r="2"/><path d="M12 7v11"/><path d="M5 14a7 7 0 0 0 14 0"/><path d="M5 14h3M19 14h-3"/></svg>` },
    { name: "Bell", svg: `<svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.7" stroke-linecap="round" stroke-linejoin="round"><path d="M18 8a6 6 0 1 0-12 0c0 7-2 7-2 7h16s-2 0-2-7"/><path d="M10 19a2 2 0 0 0 4 0"/></svg>` },
    { name: "Shield", svg: `<svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.7" stroke-linecap="round" stroke-linejoin="round"><path d="M12 2l8 4v7c0 5-3.5 9-8 9s-8-4-8-9V6l8-4z"/><path d="M12 6v10"/></svg>` },
    { name: "Candle", svg: `<svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.7" stroke-linecap="round" stroke-linejoin="round"><path d="M12 3c1 1 1.2 2.2 0 3.2C10.8 5.2 11 4 12 3z"/><path d="M9 10h6v10H9z"/><path d="M8 20h8"/></svg>` },
    { name: "Compass", svg: `<svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.7" stroke-linecap="round" stroke-linejoin="round"><circle cx="12" cy="12" r="9"/><path d="M14.5 9.5l-2 5-5 2 2-5 5-2z"/></svg>` },
    { name: "Gem", svg: `<svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.7" stroke-linecap="round" stroke-linejoin="round"><path d="M6 3h12l3 6-9 12L3 9l3-6z"/><path d="M3 9h18"/><path d="M9 9l3 12 3-12"/></svg>` },
    { name: "Spiral", svg: `<svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.7" stroke-linecap="round" stroke-linejoin="round"><path d="M12 5a7 7 0 1 0 7 7c0-2.5-2-4-4.5-4S10 9.3 10 11.2c0 1.5 1.2 2.3 2.6 2.3 1.1 0 2-.7 2-1.7"/></svg>` },
    { name: "Hand", svg: `<svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.7" stroke-linecap="round" stroke-linejoin="round"><path d="M7 12V6a1 1 0 0 1 2 0v5"/><path d="M9 11V5a1 1 0 0 1 2 0v6"/><path d="M11 11V6a1 1 0 0 1 2 0v5"/><path d="M13 12V7a1 1 0 0 1 2 0v8c0 3-2 5-5 5H8c-2.2 0-4-1.8-4-4v-3c0-.8.7-1.5 1.5-1.5S7 12 7 12z"/></svg>` },
    { name: "Cup", svg: `<svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.7" stroke-linecap="round" stroke-linejoin="round"><path d="M7 4h10v7a5 5 0 0 1-10 0V4z"/><path d="M17 6h2a2 2 0 0 1 0 4h-2"/><path d="M8 20h8"/></svg>` },
    { name: "Maple", svg: `<svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.7" stroke-linecap="round" stroke-linejoin="round"><path d="M12 2l1.5 4L18 4l-2 4 4 1.5-4 1.5 2 4-4.5-2L12 22l-1.5-9L6 15l2-4-4-1.5L8 8 6 4l4.5 2L12 2z"/></svg>` }
  ];

  // Ensure we have exactly 25 icons for 5x5
  if (ICONS.length !== 25) {
    console.warn("Expected 25 icons, found:", ICONS.length);
  }

  // ---------------------------
  // Daily layout and category assignment
  // ---------------------------
  const gridEl = document.getElementById("grid");
  const todayPill = document.getElementById("todayPill");
  const resultTitle = document.getElementById("resultTitle");
  const resultText = document.getElementById("resultText");
  const scoreLine = document.getElementById("scoreLine");
  const statsBox = document.getElementById("statsBox");
  const lockNote = document.getElementById("lockNote");
  const resetBtn = document.getElementById("resetBtn");
  const buyWrap = document.getElementById("buyWrap");
  const buyLink = document.getElementById("buyLink");

  // Optional: set this to your future book page
  // buyLink.href = "https://example.com";
  // buyWrap.style.display = "inline";

  const uid = getOrCreateUID();
  const todayKey = formatDateLocal(new Date());
  todayPill.textContent = `Today: ${todayKey}`;

  // Lock state stored per day
  function loadLast() {
    try { return JSON.parse(localStorage.getItem(LS.last) || "null"); }
    catch { return null; }
  }
  function saveLast(obj) {
    localStorage.setItem(LS.last, JSON.stringify(obj));
  }

  function loadStats() {
    try {
      return JSON.parse(localStorage.getItem(LS.stats) || "null") || {
        plays: 0,
        mega: 0,
        lucky: 0,
        meh: 0,
        unlucky: 0
      };
    } catch {
      return { plays: 0, mega: 0, lucky: 0, meh: 0, unlucky: 0 };
    }
  }
  function saveStats(s) {
    localStorage.setItem(LS.stats, JSON.stringify(s));
  }

  // Create a deterministic daily shuffle for THIS user
  const seedBase = `${todayKey}|${uid}|v1`;
  const rng = mulberry32(hashString(seedBase));

  // Shuffle icon positions daily so the grid "feels" new
  const iconOrder = pickUniqueIndices(rng, 25, 25);

  // Pick category cells: 1 mega, 3 lucky, 1 unlucky
  const chosen = pickUniqueIndices(rng, 25, 5);
  const megaIdx = chosen[0];
  const luckyIdxs = [chosen[1], chosen[2], chosen[3]];
  const unluckyIdx = chosen[4];

  function categoryForCell(cellIndex) {
    if (cellIndex === megaIdx) return "MEGA LUCKY";
    if (luckyIdxs.includes(cellIndex)) return "LUCKY";
    if (cellIndex === unluckyIdx) return "UNLUCKY";
    return "MEH";
  }

  function badgeHTML(cat) {
    if (cat === "MEGA LUCKY") return `<span class="badge good"><strong>MEGA LUCKY</strong> 1 of 25</span>`;
    if (cat === "LUCKY") return `<span class="badge good"><strong>LUCKY</strong> 3 of 25</span>`;
    if (cat === "UNLUCKY") return `<span class="badge bad"><strong>UNLUCKY</strong> 1 of 25</span>`;
    return `<span class="badge"><strong>MEH</strong> 20 of 25</span>`;
  }

  function copyFor(cat) {
    if (cat === "MEGA LUCKY") return "Bang on. Either you’re blessed today, or you have a suspicious relationship with randomness.";
    if (cat === "LUCKY") return "A good day to take the long way, try the thing, send the message, or buy the toast.";
    if (cat === "UNLUCKY") return "Not dangerous. Just mildly cursed. Keep your drinks away from your keyboard.";
    return "Nothing dramatic. A normal day in a universe that does not care.";
  }

  function renderStats() {
    const s = loadStats();
    statsBox.style.display = "grid";
    statsBox.innerHTML = `
      <div class="stat"><div class="k">Days tested</div><div class="v">${s.plays}</div></div>
      <div class="stat"><div class="k">Mega lucky</div><div class="v">${s.mega}</div></div>
      <div class="stat"><div class="k">Lucky</div><div class="v">${s.lucky}</div></div>
      <div class="stat"><div class="k">Unlucky</div><div class="v">${s.unlucky}</div></div>
    `;
  }

  function lockGrid(locked) {
    const tiles = gridEl.querySelectorAll(".tile");
    tiles.forEach(t => {
      if (locked) t.setAttribute("disabled", "true");
      else t.removeAttribute("disabled");
    });
  }

  function showResult(chosenCell, chosenIconName) {
    const cat = categoryForCell(chosenCell);
    resultTitle.textContent = `Result: ${cat}`;
    resultText.textContent = copyFor(cat);
    scoreLine.style.display = "flex";
    scoreLine.innerHTML = `
      ${badgeHTML(cat)}
      <span class="badge">You picked: <strong>${chosenIconName}</strong></span>
      <span class="badge">One pick per day</span>
    `;

    // Update stats
    const s = loadStats();
    s.plays += 1;
    if (cat === "MEGA LUCKY") s.mega += 1;
    else if (cat === "LUCKY") s.lucky += 1;
    else if (cat === "UNLUCKY") s.unlucky += 1;
    else s.meh += 1;
    saveStats(s);
    renderStats();

    // Save daily lock
    saveLast({
      date: todayKey,
      chosenCell,
      chosenIconName,
      category: cat
    });

    lockNote.textContent = "Locked for today. Come back tomorrow.";
    lockGrid(true);
  }

  function restoreIfPlayed() {
    const last = loadLast();
    if (last && last.date === todayKey) {
      // Restore the saved result
      resultTitle.textContent = `Result: ${last.category}`;
      resultText.textContent = copyFor(last.category);
      scoreLine.style.display = "flex";
      scoreLine.innerHTML = `
        ${badgeHTML(last.category)}
        <span class="badge">You picked: <strong>${last.chosenIconName}</strong></span>
        <span class="badge">One pick per day</span>
      `;
      renderStats();
      lockNote.textContent = "Locked for today. Come back tomorrow.";
      lockGrid(true);
      return true;
    }
    lockNote.textContent = "Not locked. One pick available today.";
    renderStats();
    return false;
  }

  // ---------------------------
  // Render grid
  // ---------------------------
  function renderGrid() {
    gridEl.innerHTML = "";
    for (let cell = 0; cell < 25; cell++) {
      const iconIndex = iconOrder[cell];
      const icon = ICONS[iconIndex];
      const tile = document.createElement("button");
      tile.type = "button";
      tile.className = "tile";
      tile.setAttribute("aria-label", `Pick ${icon.name}`);
      tile.innerHTML = icon.svg + `<div class="label">${icon.name}</div>`;
      tile.addEventListener("click", () => {
        const last = loadLast();
        if (last && last.date === todayKey) return; // already played
        showResult(cell, icon.name);
      });
      gridEl.appendChild(tile);
    }
  }

  // Dev reset (kept simple)
  resetBtn.addEventListener("click", () => {
    localStorage.removeItem(LS.last);
    localStorage.removeItem(LS.stats);
    resultTitle.textContent = "Pick your lucky symbol for today.";
    resultText.textContent = "No hints. No do-overs. We are not calling this science.";
    scoreLine.style.display = "none";
    lockNote.textContent = "Not locked. One pick available today.";
    renderStats();
    lockGrid(false);
  });

  renderGrid();
  restoreIfPlayed();
</script>
</body>
</html>
